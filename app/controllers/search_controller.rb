class SearchController < ApplicationController

  #
  # Method that returns a list of tickers that are matching the term.
  #
  def autocomplete_security_ticker
    term = params[:term]
    if term && !term.empty?

      if term[0] == ':'
        term = term[1..term.length]
        items = Filter.select("distinct cid, , sid, name as shortname, description as longname").
                    where("LOWER(CONCAT(name, description)) like ?", '%' + term.downcase + '%').
                    limit(10).order(:shortname)
      else
        items = Security.select("distinct cid, sid, ticker as shortname, name as longname").
            where("LOWER(CONCAT(ticker, name)) like ?", '%' + term.downcase + '%').
            limit(10).order(:shortname)
      end

    else
      items = {}
    end

    render :json => json_for_autocomplete(items, :shortname, [:sid, :cid, :longname])
    
  end

  #
  # Method that returns a list of comparable investmentments for a particular ticker
  #
  def comparables_for_ticker
  end

  #
  # Method that returns details data for a particular ticker for detailed view
  #
  def details_for_ticker
  end

end
